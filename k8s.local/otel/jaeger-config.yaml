apiVersion: v1
data:
  config.yaml: |
    service:
      extensions: [jaeger_storage, jaeger_query]

      pipelines:
        traces:
          receivers: [otlp]
          processors: [batch]
          exporters: [jaeger_storage_exporter, spanmetrics]
        metrics/spanmetrics:
          receivers: [spanmetrics]
          exporters: [prometheus]
        metrics:
          receivers: [otlp]
          exporters: [prometheus]

      telemetry:
        logs:
          level: info
        metrics:
          level: none # Deshabilitar m√©tricas de telemetry

    extensions:
      jaeger_query:
        storage:
          traces: trace_storage
          metrics: metrics_storage
      jaeger_storage:
        backends:
          trace_storage:
            badger:
              directories:
                keys: "/data/traces/"
                values: "/data/traces/"
              ephemeral: false
              ttl:
                spans: 48h
        metric_backends:
          metrics_storage:
            prometheus:
              endpoint: http://prometheus
              normalize_calls: true
              normalize_duration: true

    connectors:
      spanmetrics:

    processors:
      batch:

    receivers:
      otlp:
        protocols:
          grpc:
            endpoint: "0.0.0.0:4317"
          http:
            endpoint: "0.0.0.0:4318"

    exporters:
      jaeger_storage_exporter:
        trace_storage: trace_storage
      prometheus:
        endpoint: "0.0.0.0:8888"
kind: ConfigMap
metadata:
  name: jaeger-config
